{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nconst API_KEY = '47426000-935f334b470be797f22188feb';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function servicePhoto(value, page, per_page) {\n  const response = await axios(BASE_URL, {\n    params: {\n      key: API_KEY,\n      q: value,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page,\n    },\n  });\n  // const allPages = Math.ceil(photo.totalHits / per_page);\n  return response.data;\n}\n","export function createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class=\"photo-item\">\n        <a class=\"photo-link\" href=\"${largeImageURL}\" >\n        <img class=\"photo-img\" src=${webformatURL} alt=\"${tags}\"/>\n       </a> \n\n       <div class=\"photo-info-container\">\n          <div class=\"photo-info-item\">\n          <span class=\"photo-info-label\">Likes</span>\n          <span class=\"photo-info-value\">${likes}</span>\n          </div>\n          <div class=\"photo-info-item\">\n          <span class=\"photo-info-label\">Views</span>\n          <span class=\"photo-info-value\">${views}</span>\n          </div>\n          <div class=\"photo-info-item\">\n          <span class=\"photo-info-label\">Comments</span>\n          <span class=\"photo-info-value\">${comments}</span>\n          </div>\n          <div class=\"photo-info-item\">\n          <span class=\"photo-info-label\">Downloads</span>\n          <span class=\"photo-info-value\">${downloads}</span>\n          </div>\n       </div>\n       </li>`\n    )\n    .join('');\n}\n","import { servicePhoto } from './js/pixabay-api';\nimport { createMarkup } from './js/render-functions';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst form = document.querySelector('.form-search');\nconst spinner = document.querySelector('.loader');\nconst gallery = document.querySelector('.image-gallery');\nconst loadMore = document.querySelector('.load-more-btn');\n\nlet page;\nlet value;\nconst per_page = 30;\n\nform.addEventListener('submit', handleSubmit);\n\nconst galleryBox = new SimpleLightbox('.image-gallery a', {\n  overlayOpacity: 0.8,\n  captionsData: 'alt',\n  captionDelay: 250,\n  captionPosition: 'bottom',\n  captionType: 'attr',\n});\n\n// ======================================================================\n\nasync function handleSubmit(event) {\n  event.preventDefault();\n  spinner.style.visibility = 'visible';\n  page = 1;\n\n  value = event.target.elements.imageQuery.value.trim();\n  if (!value) {\n    spinner.style.visibility = 'hidden';\n    return;\n  }\n\n  try {\n    const photo = await servicePhoto(value, page, per_page);\n    gallery.innerHTML = '';\n    if (!photo.total) {\n      iziToast.show({\n        backgroundColor: 'red',\n        position: 'topRight',\n        messageColor: 'white',\n        iconColor: 'white',\n        maxWidth: 432,\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n      loadMore.style.visibility = 'hidden';\n      return;\n    }\n    console.log(photo);\n    gallery.innerHTML = createMarkup(photo.hits);\n\n    const allPages = Math.ceil(photo.totalHits / per_page);\n    if (page === allPages) {\n      iziToast.show({\n        backgroundColor: 'blue',\n        position: 'topRight',\n        messageColor: 'white',\n        iconColor: 'white',\n        maxWidth: 432,\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n      loadMore.style.visibility = 'hidden';\n    } else {\n      loadMore.style.visibility = 'visible';\n    }\n    galleryBox.refresh();\n\n    form.reset();\n  } catch (error) {\n    iziToast.error({\n      backgroundColor: 'red',\n      position: 'topRight',\n      messageColor: 'white',\n      iconColor: 'white',\n      maxWidth: 432,\n      message: error.message,\n    });\n    console.log(error.message);\n    loadMore.style.visibility = 'hidden';\n  } finally {\n    spinner.style.visibility = 'hidden';\n  }\n}\n\n// =================================================================\n\nloadMore.addEventListener('click', handleLoadMore);\n\nasync function handleLoadMore(event) {\n  event.preventDefault();\n  page += 1;\n  spinner.style.visibility = 'visible';\n\n  try {\n    const photo = await servicePhoto(value, page, per_page);\n\n    gallery.insertAdjacentHTML('beforeend', createMarkup(photo.hits));\n\n    const card = document.querySelector('.photo-item');\n    const cardHeight = card.getBoundingClientRect().height;\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n\n    galleryBox.refresh();\n\n    const allPages = Math.ceil(photo.totalHits / per_page);\n    if (page === allPages) {\n      loadMore.style.visibility = 'hidden';\n      iziToast.show({\n        backgroundColor: 'blue',\n        position: 'topRight',\n        messageColor: 'white',\n        iconColor: 'white',\n        maxWidth: 432,\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      backgroundColor: 'red',\n      position: 'topRight',\n      messageColor: 'white',\n      iconColor: 'white',\n      maxWidth: 432,\n      message: error.message,\n    });\n    console.log(error.message);\n  } finally {\n    spinner.style.visibility = 'hidden';\n  }\n}\n"],"names":["API_KEY","BASE_URL","servicePhoto","value","page","per_page","axios","createMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","form","spinner","gallery","loadMore","handleSubmit","galleryBox","SimpleLightbox","event","photo","iziToast","allPages","error","handleLoadMore","cardHeight"],"mappings":"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"}